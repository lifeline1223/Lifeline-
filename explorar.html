<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Explorar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background: #000;
      color: white;
      overflow-x: hidden;
    }
    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: #111;
      padding: 10px 14px;
      z-index: 10;
    }
    .top-bar {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .top-bar .material-icons {
      font-size: 24px;
      cursor: pointer;
    }
    .top-bar .title {
      font-size: 18px;
      font-weight: bold;
    }
    .search-bar {
      margin-top: 10px;
      display: flex;
      align-items: center;
      background: #222;
      border-radius: 20px;
      padding: 8px 12px;
      cursor: pointer;
    }
    .search-bar i {
      margin-right: 8px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      grid-auto-rows: 140px;
      gap: 2px;
      margin-top: 100px;
      padding-bottom: 100px;
    }

    .item {
      position: relative;
      cursor: pointer;
      overflow: hidden;
    }

    .item img, .item video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .item-text {
      background: #333;
      color: white;
      padding: 10px;
      font-size: 14px;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .icon-overlay {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(0,0,0,0.6);
      border-radius: 50%;
      padding: 4px 8px;
      font-size: 14px;
      font-weight: bold;
      color: white;
    }
  </style>
</head>
<body>

<header>
  <div class="top-bar">
    <i class="material-icons" onclick="history.back()">arrow_back</i>
    <div class="title">Explorar</div>
  </div>
  <div class="search-bar" onclick="window.location.href='pesquisa1.html'">
    <i class="material-icons">search</i>
    <span>Pesquisar...</span>
  </div>
</header>

<div class="grid" id="exploreGrid"></div>

<script>
  const grid = document.getElementById("exploreGrid");

  function adicionarConteudos(qtd = 12) {
    for (let i = 0; i < qtd; i++) {
      const tipo = Math.floor(Math.random() * 3);
      const link = document.createElement("a");
      link.href = "Reall.html";
      link.className = "item";

      if (tipo === 0) {
        // Foto
        link.innerHTML = `<img src="https://source.unsplash.com/300x300/?face&sig=${Math.random()*1000}" />
        <div class="icon-overlay"><i class="material-icons">image</i></div>`;
      } else if (tipo === 1) {
        // Vídeo
        link.innerHTML = `<video src="https://www.w3schools.com/html/mov_bbb.mp4" autoplay muted loop></video>
        <div class="icon-overlay"><i class="material-icons">play_circle</i></div>`;
      } else {
        // Texto
        link.innerHTML = `<div class="item-text" style="background: hsl(${Math.random()*360}, 60%, 30%)">
          Publicação: ${Math.floor(Math.random()*9999)}
        </div>
        <div class="icon-overlay">Tt</div>`;
      }

      grid.appendChild(link);
    }
  }

  // Scroll infinito ao descer
  window.addEventListener("scroll", () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) {
      adicionarConteudos(9);
    }
  });

  // Atualizar ao puxar para baixo no topo
  let startY = 0;
  document.addEventListener("touchstart", e => {
    if (window.scrollY === 0) startY = e.touches[0].clientY;
  });
  document.addEventListener("touchend", e => {
    if (window.scrollY === 0 && e.changedTouches[0].clientY - startY > 80) {
      atualizarConteudoCompleto();
    }
  });

  // Novo: Atualizar ao dar 3 toques rápidos na tela
  let toqueCount = 0;
  let toqueTimer;
  document.addEventListener("touchend", () => {
    toqueCount++;
    if (toqueTimer) clearTimeout(toqueTimer);
    toqueTimer = setTimeout(() => toqueCount = 0, 500);
    if (toqueCount >= 3) {
      atualizarConteudoCompleto(true);
      toqueCount = 0;
    }
  });

  // Atualização completa: limpa e recarrega
  function atualizarConteudoCompleto(scrollToTop = false) {
    grid.innerHTML = "";
    adicionarConteudos(15);
    if (scrollToTop) window.scrollTo({ top: 0, behavior: "smooth" });
  }

  // Inicial
  adicionarConteudos(15);
</script>

</body>
</html>