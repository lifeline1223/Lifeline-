<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Perfil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: #111;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 100;
      border-bottom: 1px solid #222;
    }

    .material-icons { cursor: pointer; }

    .content {
      padding-top: 60px;
      overflow-y: auto;
      height: calc(100vh - 60px);
    }

    .profile {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 10px 10px;
    }

    .profile img {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      border: 3px solid #1e90ff;
      margin-bottom: 10px;
    }

    .profile h2 {
      font-size: 18px;
      margin-bottom: 5px;
    }

    .profile p {
      font-size: 14px;
      color: #ccc;
      text-align: center;
      padding: 0 10px;
    }

    .follow-info {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 15px 0;
    }

    .follow-info span {
      cursor: pointer;
      color: #1e90ff;
    }

    .tabs {
      display: flex;
      justify-content: space-around;
      background: #111;
      border-top: 1px solid #222;
      border-bottom: 1px solid #222;
    }

    .tabs i {
      font-size: 28px;
      cursor: pointer;
      padding: 10px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2px;
      padding: 5px;
    }

    .grid img, .grid video, .grid .text {
      width: 100%;
      height: 120px;
      object-fit: cover;
      background: #222;
      cursor: pointer;
      position: relative;
    }

    .views {
      position: absolute;
      bottom: 5px;
      right: 5px;
      font-size: 11px;
      background: rgba(0,0,0,0.6);
      padding: 2px 6px;
      border-radius: 12px;
      display: flex;
      align-items: center;
    }

    .views i {
      font-size: 13px;
      margin-right: 2px;
    }

    .options-menu {
      position: absolute;
      top: 50px;
      right: 10px;
      background: #222;
      border-radius: 8px;
      display: none;
      flex-direction: column;
      z-index: 200;
      width: 180px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }

    .options-menu div {
      padding: 10px;
      border-bottom: 1px solid #333;
      cursor: pointer;
    }

    .options-menu div:last-child {
      border-bottom: none;
    }

    .options-menu div:hover {
      background: #333;
    }

    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      z-index: 99;
      display: none;
    }

    .vermais-dropdown {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      border-top: 1px solid #333;
      padding: 20px;
      display: none;
      flex-direction: column;
      gap: 15px;
      z-index: 300;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }

    .vermais-dropdown button {
      background: #222;
      color: white;
      padding: 12px;
      border: none;
      border-radius: 6px;
      text-align: left;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
    }

    .vermais-dropdown button:hover {
      background: #333;
    }

    .star-icon {
      color: #999;
      font-size: 20px;
    }

    .favoritado .star-icon {
      color: gold;
    }
  </style>
</head>
<body>
  <header>
    <div onclick="voltar()"><i class="material-icons">arrow_back</i></div>
    <div onclick="toggleOptions()"><i class="material-icons">more_vert</i></div>
  </header>

  <div class="overlay" id="overlay" onclick="closeAll()"></div>

  <div class="content" onclick="closeOptions()">
    <div class="profile">
      <img src="perfil1.jpg" alt="Foto de perfil">
      <h2>João Salvador</h2>
      <p>Explorando ideias, criando conexões. Bem-vindo ao meu espaço pessoal.</p>
    </div>

    <div class="follow-info">
      <span onclick="abrirSeguidores()">1.2k Seguidores</span>
      <span onclick="abrirSeguindo()">200 Seguindo</span>
    </div>

    <div class="tabs">
      <i class="material-icons" onclick="mostrarConteudo()">grid_on</i>
      <i class="material-icons" onclick="mostrarGuardados()">bookmark</i>
    </div>

    <div class="grid" id="conteudos"></div>
  </div>

  <div class="options-menu" id="optionsMenu">
    <div onclick="bloquear()">Bloquear</div>
    <div onclick="location.href='denunciar.html'">Denunciar</div>
    <div onclick="copiarURL()">Copiar URL do perfil</div>
    <div onclick="location.href='partilhar.html'">Partilhar perfil</div>
    <div onclick="abrirVerMais()">Ver mais</div>
  </div>

  <div class="vermais-dropdown" id="verMaisMenu">
    <button onclick="naoSeguir()">Não seguir</button>
    <button onclick="ativarNotificacao()">Ativar notificações</button>
    <button onclick="toggleFavorito(this)"><span class="star-icon material-icons">star</span> Adicionar aos favoritos</button>
  </div><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
  // Configuração do Firebase
  const firebaseConfig = {
    databaseURL: "https://lifeline-78bce-default-rtdb.firebaseio.com/"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Suponha que esse ID do usuário visitado seja passado dinamicamente
  const userId = "usuarioVisitado123";
  const meuId = "meuUsuario456";

  const conteudosDiv = document.getElementById("conteudos");

  // Dados falsos apenas como exemplo
  const conteudosExemplo = [
    { tipo: "foto", url: "foto1.jpg", views: 102 },
    { tipo: "video", url: "video1.mp4", views: 88 },
    { tipo: "texto", conteudo: "O dia em que tudo mudou.", views: 120 }
  ];

  // Mostrar conteúdo padrão
  function mostrarConteudo() {
    conteudosDiv.innerHTML = "";
    conteudosExemplo.forEach(item => {
      if (item.tipo === "foto") {
        conteudosDiv.innerHTML += `
          <div class="grid-item">
            <img src="${item.url}">
            <div class="views"><i class="material-icons">visibility</i>${item.views}</div>
          </div>`;
      } else if (item.tipo === "video") {
        conteudosDiv.innerHTML += `
          <div class="grid-item">
            <video src="${item.url}" muted></video>
            <div class="views"><i class="material-icons">visibility</i>${item.views}</div>
          </div>`;
      } else {
        conteudosDiv.innerHTML += `
          <div class="text">
            <p style="padding: 5px;">${item.conteudo}</p>
            <div class="views"><i class="material-icons">visibility</i>${item.views}</div>
          </div>`;
      }
    });
  }

  // Mostrar guardados
  function mostrarGuardados() {
    conteudosDiv.innerHTML = "";
    db.ref(`guardados/${meuId}/${userId}`).once("value", snapshot => {
      if (snapshot.exists()) {
        const dados = snapshot.val();
        Object.values(dados).forEach(item => {
          conteudosDiv.innerHTML += `<div class="text"><p style="padding: 5px;">${item}</p></div>`;
        });
      } else {
        conteudosDiv.innerHTML = "<p style='color: #999; text-align: center;'>Nenhum conteúdo guardado.</p>";
      }
    });
  }

  // Botão de voltar
  function voltar() {
    if (document.referrer) {
      location.href = document.referrer;
    } else {
      history.back();
    }
  }

  // Menu de opções
  function toggleOptions() {
    document.getElementById("optionsMenu").style.display = "flex";
    document.getElementById("overlay").style.display = "block";
  }

  function closeOptions() {
    document.getElementById("optionsMenu").style.display = "none";
  }

  function closeAll() {
    closeOptions();
    document.getElementById("verMaisMenu").style.display = "none";
    document.getElementById("overlay").style.display = "none";
  }

  function abrirVerMais() {
    document.getElementById("verMaisMenu").style.display = "flex";
    document.getElementById("overlay").style.display = "block";
    closeOptions();
  }

  // BLOQUEAR
  function bloquear() {
    db.ref(`bloqueados/${meuId}/${userId}`).set(true);
    alert("Perfil bloqueado. Você não verá mais esse usuário.");
  }

  // COPIAR URL
  function copiarURL() {
    const url = window.location.href;
    navigator.clipboard.writeText(url);
    const msg = document.createElement("div");
    msg.innerText = "Perfil copiado";
    msg.style.position = "fixed";
    msg.style.bottom = "20px";
    msg.style.left = "50%";
    msg.style.transform = "translateX(-50%)";
    msg.style.background = "#222";
    msg.style.color = "#fff";
    msg.style.padding = "10px 20px";
    msg.style.borderRadius = "8px";
    msg.style.zIndex = 1000;
    document.body.appendChild(msg);
    setTimeout(() => msg.remove(), 2000);
  }

  // NÃO SEGUIR
  function naoSeguir() {
    db.ref(`seguindo/${meuId}/${userId}`).remove();
    db.ref(`seguidores/${userId}/${meuId}`).remove();
    alert("Você deixou de seguir este perfil.");
  }

  // NOTIFICAÇÃO
  function ativarNotificacao() {
    db.ref(`notificacoes/${meuId}/${userId}`).set(true);
    alert("Você receberá notificações desse perfil.");
  }

  // FAVORITO
  function toggleFavorito(btn) {
    const favoritoRef = db.ref(`favoritos/${meuId}/${userId}`);
    favoritoRef.once("value", snapshot => {
      if (snapshot.exists()) {
        favoritoRef.remove();
        btn.classList.remove("favoritado");
        alert("Removido dos favoritos.");
      } else {
        favoritoRef.set(true);
        btn.classList.add("favoritado");
        alert("Adicionado aos favoritos.");
      }
    });
  }

  // Seguidores e seguindo em tempo real
  function abrirSeguidores() {
    db.ref(`seguidores/${userId}`).once("value", snap => {
      const total = snap.exists() ? Object.keys(snap.val()).length : 0;
      alert(`Seguidores: ${total}`);
    });
  }

  function abrirSeguindo() {
    db.ref(`seguindo/${userId}`).once("value", snap => {
      const total = snap.exists() ? Object.keys(snap.val()).length : 0;
      alert(`Seguindo: ${total}`);
    });
  }

  // Inicialização
  mostrarConteudo();
</script>
</body>
</html>